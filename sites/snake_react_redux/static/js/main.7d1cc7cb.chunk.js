(this.webpackJsonpsnake_react_redux=this.webpackJsonpsnake_react_redux||[]).push([[0],{18:function(e,t,n){e.exports=n(29)},23:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(5),o=n.n(r);n(23),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(4),c=n(11),d=n(1);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=Object(d.createStandardAction)("snake/TURN_LEFT")(),p=Object(d.createStandardAction)("snake/TURN_RIGHT")(),v=Object(d.createStandardAction)("snake/TURN_UP")(),f=Object(d.createStandardAction)("snake/TURN_DOWN")(),y=Object(d.createStandardAction)("snake/START_GAME")(),k=Object(d.createStandardAction)("snake/STOP_GAME")(),b=Object(d.createStandardAction)("snake/MOVE_SNAKE")(),O=Object(d.createStandardAction)("snake/CREATE_FOOD")(),m=Object(d.createStandardAction)("snake/INCREASE_BODY")(),x={direction:{x:0,y:0},position:{x:0,y:0},speed:10,inGame:!1,size:10,body:[{x:0,y:0}]},w=Object(d.createReducer)(x).handleAction("snake/TURN_LEFT",(function(e){return u({},e,{direction:{x:-1,y:0}})})).handleAction("snake/TURN_RIGHT",(function(e){return u({},e,{direction:{x:1,y:0}})})).handleAction("snake/TURN_UP",(function(e){return u({},e,{direction:{x:0,y:-1}})})).handleAction("snake/TURN_DOWN",(function(e){return u({},e,{direction:{x:0,y:1}})})).handleAction("snake/START_GAME",(function(e){return u({},e,{inGame:!0})})).handleAction("snake/STOP_GAME",(function(e){return x})).handleAction("snake/MOVE_SNAKE",(function(e,t){var n=t.payload;n.x,n.y;console.log("moveSnake1",t.payload);var a=e.body.map((function(t,n){return 0===n?{x:t.x,y:t.y}:e.body[n-1]}));return a[0].x+=t.payload.x,a[0].y+=t.payload.y,u({},e,{body:a})})).handleAction("snake/CREATE_FOOD",(function(e,t){return u({},e,{food:t.payload})})).handleAction("snake/INCREASE_BODY",(function(e,t){var n=e.body.slice();return n.push(t.payload),u({},e,{body:n})})),A=Object(s.b)({snake:w}),_=n(13),S=n(14),E=n(16),g=n(15),R=n(17),T=n(6),j=function(e){function t(e){var n;return Object(_.a)(this,t),(n=Object(E.a)(this,Object(g.a)(t).call(this,e))).canvasRef=void 0,n.props=void 0,n.prevProps=void 0,n.timer=void 0,n.animater=void 0,n.canvasRef=i.a.createRef(),n.props=e,n.prevProps=e,n.timer=void 0,n.animater=void 0,n}return Object(R.a)(t,e),Object(S.a)(t,[{key:"getCanvasAndContext",value:function(){var e=this.canvasRef.current,t=e&&e.getContext("2d");return{_canvas:e,_ctx:t}}},{key:"componentDidMount",value:function(){this.clearCanvas(),this.initText(),window.addEventListener("keyup",this.keyDownHandler.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keyup",this.keyDownHandler.bind(this))}},{key:"componentWillReceiveProps",value:function(){this.prevProps=this.props}},{key:"updateSnake",value:function(){var e=this.props.direction,t=e.x,n=e.y,a=this.props.body[0],i=a.x,r=a.y,o=this.props,s=o.size,c=o.food;if(JSON.stringify(this.props)===JSON.stringify(this.prevProps))return!0;var d=i+t*s,l=r+n*s;if(!this.isSnakeAlive(d,l))return!this.timer&&clearTimeout(this.timer),!this.animater&&window.cancelAnimationFrame(this.animater),this.timer=void 0,this.animater=void 0,N.dispatch(k()),!1;if(void 0!==c&&d===c.x&&l===c.y){var u,h,p=this.props.body[this.props.body.length-1];u=p.x-t*s,h=p.y+n*s,N.dispatch(m({x:u,y:h})),this.createFood()}return N.dispatch(b({x:t*s,y:n*s})),!0}},{key:"drawSnake",value:function(){var e=this.props.size,t=this.getCanvasAndContext(),n=t._canvas,a=t._ctx;this.props.body.forEach((function(t,i){var r=t.x,o=t.y;null!==n&&null!==a&&(a.fillStyle=0!==i?"black":"blue",a.fillRect(r,o,e,e))}))}},{key:"drawFood",value:function(){var e=this.props.food||{x:0,y:0},t=e.x,n=e.y,a=this.props.size,i=this.getCanvasAndContext(),r=i._canvas,o=i._ctx;null!==r&&null!==o&&(o.fillStyle="red",o.fillRect(t,n,a,a))}},{key:"isSnakeAlive",value:function(e,t){var n=this.getCanvasAndContext(),a=n._canvas,i=n._ctx,r=this.props.size;if(!this.props.inGame)return!1;if(e<0||t<0)return!1;if(null!==a&&null!==i){var o=a.width,s=a.height;if(e+r>o||t+r>s)return!1}var c=this.props.body.findIndex((function(n){return n.x===e&&n.y===t}));return!(c>0&&c<this.props.body.length-1)}},{key:"clearCanvas",value:function(){var e=this.getCanvasAndContext(),t=e._canvas,n=e._ctx;null!==n&&null!==t&&(n.fillStyle="gray",n.fillRect(0,0,t.width,t.height))}},{key:"initText",value:function(){var e=this.getCanvasAndContext(),t=e._canvas,n=e._ctx;if(null!==n&&null!==t){var a=n.createLinearGradient(0,0,t.width,0);a.addColorStop(0," magenta"),a.addColorStop(.5,"blue"),a.addColorStop(1,"red"),n.fillStyle=a,n.font="30px Courier",n.textAlign="center",n.fillText("Hello Snake!",t.width/2,t.height/2),n.font="15px Courier",n.textAlign="center",n.fillText("Press Enter to Start!",t.width/2,t.height/2+20)}}},{key:"animate",value:function(){var e=this;console.log("update...",this.props.direction,this.props.body[0],this.props.inGame),this.clearCanvas(),this.updateSnake()?(this.drawFood(),this.drawSnake(),this.timer=setTimeout((function(){e.animater=window.requestAnimationFrame(e.animate.bind(e))}),1e3/this.props.speed)):this.initText()}},{key:"startSnake",value:function(){console.log("Start Snake!!!"),this.clearCanvas(),N.dispatch(y()),this.createFood(),this.animate()}},{key:"createFood",value:function(){var e=this,t=(this.canvasRef.current&&this.canvasRef.current.width||400)/this.props.size,n=(this.canvasRef.current&&this.canvasRef.current.height||400)/this.props.size,a=function(t,n){return(Math.floor(Math.random()*(n-t))+t)*e.props.size},i=a(0,t),r=a(0,n);N.dispatch(O({x:i,y:r}))}},{key:"keyDownHandler",value:function(e){var t=this.props.inGame;switch(e.key){case"Enter":!t&&this.startSnake();break;case"ArrowUp":N.dispatch(v());break;case"ArrowDown":N.dispatch(f());break;case"ArrowLeft":N.dispatch(h());break;case"ArrowRight":N.dispatch(p());break;case"Escape":N.dispatch(k())}}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("canvas",{ref:this.canvasRef,width:400,height:400}))}}]),t}(i.a.Component),C=Object(T.b)((function(e){return e.snake}))(j);n.d(t,"store",(function(){return N}));var N=Object(s.c)(A,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(i.a.createElement(T.a,{store:N},i.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[18,1,2]]]);
//# sourceMappingURL=main.7d1cc7cb.chunk.js.map